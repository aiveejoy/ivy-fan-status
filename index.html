<!DOCTYPE html>
<html>

<head>
    <title>Fan Controller</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
</head>

<body>
    <br>
    <br>
    <br>
    <center>
        <div>
            <h1>
                IOT FAN SWITCH
            </h1>
            <p>
                The fan is currently turned<span id="status"> </span>
            </p>
        </div>
        <button type="button" class="btn btn-dark" id="dark">Off</button>
        <button type="button" class="btn btn-primary" id="uno">1</button>
        <button type="button" class="btn btn-secondary" id="dos">2</button>
        <button type="button" class="btn btn-success" id="tres">3</button>
        <div>

        </div>
    </center>

</body>
<script src="browserMqtt.js"></script>
<script>
    $(document).ready(function () {
        client = mqtt.connect("wss://test.mosquitto.org:8081/mqtt");
        client.on("connect", function () {
            console.log("connected");


        })
        $("#dark").click(function () {
            console.log("dark");
            var dt = new Date();
            var time = dt.getHours() + ":" + dt.getMinutes() + ":" + dt.getSeconds();
            client.publish("ivy/fan/status","Turned "+ $("#dark").text() + " : " + time);
            $("#status").text(" " + $("#dark").text());

        })
        $("#uno").click(function () {
            console.log("1");
            var dt = new Date();
            var time = dt.getHours() + ":" + dt.getMinutes() + ":" + dt.getSeconds();
            client.publish("ivy/fan/status","Turned at "+ $("#uno").text() + " : " + time);
            $("#status").text(" " + $("#uno").text());
        })
        $("#dos").click(function () {
            console.log("2");
            var dt = new Date();
            var time = dt.getHours() + ":" + dt.getMinutes() + ":" + dt.getSeconds();
            client.publish("ivy/fan/status", "Turned at "+$("#dos").text() + " : " + time);
            $("#status").text(" " + $("#dos").text());
        })
        $("#tres").click(function () {
            console.log("3");
            var dt = new Date();
            var time = dt.getHours() + ":" + dt.getMinutes() + ":" + dt.getSeconds();
            client.publish("ivy/fan/status", "Turned at "+$("#tres").text() + " : " + time);
            $("#status").text(" " + $("#tres").text());
        })


    })
</script>

</html>